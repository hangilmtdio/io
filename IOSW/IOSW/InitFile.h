#pragma once


class CInitFile
{
	/////////////////////////////////////////////////////////////////////////////
	// Operations
	/////////////////////////////////////////////////////////////////////////////
public:
	CInitFile();
	CInitFile(LPCTSTR lpszFile);
	virtual ~CInitFile();

	/////////////////////////////////////////////////////////////////////////////
	// Section을 읽어 Key 값의 갯수를 반환한다.
	/////////////////////////////////////////////////////////////////////////////
	int    ReadSection(LPCTSTR lpszSection);

	/////////////////////////////////////////////////////////////////////////////
	// Section에 해당 키값을 반환한다.
	/////////////////////////////////////////////////////////////////////////////
	CString   ReadData(LPCTSTR lpszSection, LPCTSTR lpszKey);

	/////////////////////////////////////////////////////////////////////////////
	// Section에 해당 키값에 데이터를 저장한다.
	/////////////////////////////////////////////////////////////////////////////
	BOOL   WriteData(LPCTSTR lpszSection, LPCTSTR lpszKey, LPCTSTR lpszData);

	/////////////////////////////////////////////////////////////////////////////
	// File 명 설정
	/////////////////////////////////////////////////////////////////////////////
	void   SetFile(LPCTSTR lpszFile);

	//////////////////////static
	/////////////////////////////////////////////////////////////////////////////
	// Section을 읽어 Key 값의 갯수를 반환한다.
	/////////////////////////////////////////////////////////////////////////////
	static int  ReadSection(LPCTSTR lpszFile, LPCTSTR lpszSection);
	/////////////////////////////////////////////////////////////////////////////
	// Section에 해당 키값을 반환한다.
	/////////////////////////////////////////////////////////////////////////////
	static CString ReadData(LPCTSTR lpszFile, LPCTSTR lpszSection, LPCTSTR lpszKey);

	/////////////////////////////////////////////////////////////////////////////
	// Section에 해당 키값에 데이터를 저장한다.
	/////////////////////////////////////////////////////////////////////////////
	static BOOL  WriteData(LPCTSTR lpszFile, LPCTSTR lpszSection, LPCTSTR lpszKey, LPCTSTR lpszData);



	/////////////////////////////////////////////////////////////////////////////
	// Attributes
	/////////////////////////////////////////////////////////////////////////////
private:
	CString   m_strFileName;   // 설정파일명
};
